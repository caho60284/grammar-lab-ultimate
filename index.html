<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Grammar Lab AI</title>

<style>
body{
font-family:-apple-system,BlinkMacSystemFont,"Segoe UI",Roboto,Arial;
background:#f3f6f4;
margin:0;
padding:20px;
color:#1f2d2a;
}
h1{color:#2f6f5e;margin-bottom:4px;}
.subtitle{color:#6b7c76;margin-bottom:18px;}
textarea{
width:100%;min-height:120px;border-radius:14px;
border:1px solid #d7dfdb;padding:14px;font-size:18px;
outline:none;box-sizing:border-box;background:white;
}
button{
margin-top:14px;background:#2f6f5e;color:white;
border:none;padding:12px 20px;border-radius:12px;
font-size:16px;cursor:pointer;
}
.card{
background:white;border-radius:16px;padding:16px;
margin-top:16px;box-shadow:0 2px 6px rgba(0,0,0,0.05);
}
.card h3{margin-top:0;color:#2f6f5e;}
.ok{color:#2f8f5e;font-weight:600;}
.warn{color:#d97706;font-weight:600;}
.box{background:#e6f2ee;padding:10px;border-radius:10px;font-style:italic;}
</style>
</head>

<body>

<h1>ðŸ§  Grammar Lab AI</h1>
<div class="subtitle">Flexible grammar + natural rewrite + meaning</div>

<textarea id="input" placeholder="Type sentence..."></textarea>
<br>
<button onclick="analyze()">Analisis</button>

<div id="syntax" class="card" style="display:none"></div>
<div id="issues" class="card" style="display:none"></div>
<div id="rewrite" class="card" style="display:none"></div>
<div id="meaning" class="card" style="display:none"></div>

<script>

const input = document.getElementById("input")
const syntaxBox = document.getElementById("syntax")
const issuesBox = document.getElementById("issues")
const rewriteBox = document.getElementById("rewrite")
const meaningBox = document.getElementById("meaning")

// ENTER = ANALYZE
input.addEventListener("keydown", e=>{
if(e.key==="Enter" && !e.shiftKey){
e.preventDefault()
analyze()
}
})

// =======================
// HEURISTIC REWRITE ENGINE
// =======================
function heuristicRewrite(s){

let out = s

// modal + ing â†’ base
out = out.replace(/\b(will|can|must|should)\s+(\w+)ing\b/i,"$1 $2")

// feel + ing â†’ feel like ing
out = out.replace(/\bfeel\s+(\w+ing)\b/i,"feel like $1")

// need + verb â†’ need to verb
out = out.replace(/\bneed\s+(\w+)\b/i,"need to $1")

// very + adj â†’ really + adj
out = out.replace(/\bvery\s+(\w+)\b/i,"really $1")

// I am â†’ I'm
out = out.replace(/\bI am\b/,"I'm")

return out
}

// =======================
// ISSUE DETECTOR
// =======================
function detectIssues(original,rewritten){

let issues=[]

if(original!==rewritten){

if(/\bvery\s+\w+\b/i.test(original))
issues.push("Less natural intensifier â†’ use really")

if(/\bfeel\s+\w+ing\b/i.test(original))
issues.push("Use feel like + -ing")

if(/\bneed\s+\w+\b/i.test(original) && !/\bneed to\b/i.test(original))
issues.push("need + verb â†’ need to + verb")

if(/\b(will|can|must|should)\s+\w+ing\b/i.test(original))
issues.push("Modal must use base verb")
}

return issues
}

// =======================
// SYNTAX SIMPLE
// =======================
function syntaxDetect(s){
let w = s.split(" ")
return {subject:w[0]||"",verb:w[1]||""}
}

// =======================
// SCALABLE MEANING ENGINE
// =======================
function meaningGuess(s){

// small core lexicon
const coreAdj = {
hungry:"lapar",
thirsty:"haus",
sleepy:"mengantuk",
tired:"lelah",
angry:"marah",
sad:"sedih",
happy:"bahagia",
bored:"bosan",
scared:"takut",
excited:"bersemangat"
}

// I'm really + adj
let m = s.match(/\bI'm really (\w+)\b/i)
if(m){
let adj = m[1].toLowerCase()

// known adjective
if(coreAdj[adj]) return "Aku sangat " + coreAdj[adj]

// suffix heuristic
if(adj.endsWith("ed")) return "Aku merasa " + adj
if(adj.endsWith("ing")) return "Aku sedang " + adj
if(adj.endsWith("ous")) return "Aku bersifat " + adj
if(adj.endsWith("ful")) return "Aku penuh " + adj

// fallback
return "Aku sangat merasa " + adj
}

// feel like + ing
let f = s.match(/feel like (\w+)ing/i)
if(f){
return "Aku merasa ingin " + f[1] + "ing"
}

// need to + verb
let n = s.match(/need to (\w+)/i)
if(n){
return "Aku perlu " + n[1]
}

// generic fallback
return "Makna umum: " + s
}

// =======================
// ANALYZE
// =======================
function analyze(){

let text = input.value.trim()
if(!text) return

let rewritten = heuristicRewrite(text)
let issues = detectIssues(text,rewritten)
let syn = syntaxDetect(text)
let meaning = meaningGuess(rewritten)

syntaxBox.style.display="block"
issuesBox.style.display="block"
rewriteBox.style.display="block"
meaningBox.style.display="block"

syntaxBox.innerHTML = `
<h3>Syntax</h3>
Subject: ${syn.subject}<br>
Main verb: ${syn.verb}
`

if(issues.length){
issuesBox.innerHTML = `<h3>Issues</h3><div class="warn">âš  ${issues.join("<br>âš  ")}</div>`
}else{
issuesBox.innerHTML = `<h3>Issues</h3><div class="ok">âœ” Natural & correct</div>`
}

rewriteBox.innerHTML = `
<h3>Rewrite</h3>
<div class="box">${rewritten}</div>
`

meaningBox.innerHTML = `
<h3>Meaning</h3>
<div class="box">${meaning}</div>
`
}

</script>
</body>
</html>