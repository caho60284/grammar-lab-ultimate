<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Grammar Lab</title>

<style>
body{
font-family:-apple-system,BlinkMacSystemFont,"Segoe UI",Roboto,Arial;
background:#f4f6f5;
margin:0;
padding:20px;
color:#1f2d2a;
}

h1{
color:#2f6f5e;
margin-bottom:5px;
}

.subtitle{
color:#6b7c76;
margin-bottom:20px;
}

textarea{
width:100%;
min-height:120px;
border-radius:14px;
border:1px solid #d7dfdb;
padding:14px;
font-size:18px;
outline:none;
box-sizing:border-box;
background:white;
}

button{
margin-top:14px;
background:#2f6f5e;
color:white;
border:none;
padding:12px 20px;
border-radius:12px;
font-size:16px;
cursor:pointer;
}

.card{
background:white;
border-radius:16px;
padding:16px;
margin-top:16px;
box-shadow:0 2px 6px rgba(0,0,0,0.05);
}

.card h3{
margin-top:0;
color:#2f6f5e;
}

.ok{
color:#2f8f5e;
font-weight:600;
}

.err{
color:#c0392b;
font-weight:600;
}

.rewrite{
background:#e6f2ee;
padding:10px;
border-radius:10px;
font-style:italic;
}

.meaning{
background:#e6f2ee;
padding:10px;
border-radius:10px;
font-style:italic;
}
</style>
</head>

<body>

<h1>üß† Grammar Lab</h1>
<div class="subtitle">Grammar analyzer + natural rewrite + meaning</div>

<textarea id="input" placeholder="Type sentence..."></textarea>
<br>
<button onclick="analyze()">Analisis</button>

<div id="syntax" class="card" style="display:none"></div>
<div id="issues" class="card" style="display:none"></div>
<div id="rewrite" class="card" style="display:none"></div>
<div id="meaning" class="card" style="display:none"></div>

<script>

const input = document.getElementById("input")
const syntaxBox = document.getElementById("syntax")
const issuesBox = document.getElementById("issues")
const rewriteBox = document.getElementById("rewrite")
const meaningBox = document.getElementById("meaning")

// ENTER = ANALYZE
input.addEventListener("keydown", e=>{
if(e.key==="Enter" && !e.shiftKey){
e.preventDefault()
analyze()
}
})

// =========================
// NATURAL RULES
// =========================
const naturalRules = [
{
pattern:/\bfeel\s+\w+ing\b/i,
message:"Gunakan feel like + -ing",
fix:s=>s.replace(/feel\s+(\w+ing)/i,"feel like $1")
},
{
pattern:/\bdiscuss about\b/i,
message:"discuss tidak pakai about",
fix:s=>s.replace(/discuss about/i,"discuss")
},
{
pattern:/\bdo a mistake\b/i,
message:"Gunakan make a mistake",
fix:s=>s.replace(/do a mistake/i,"make a mistake")
},
{
pattern:/\bvery hungry\b/i,
message:"Lebih natural: really hungry",
fix:s=>s.replace(/very hungry/i,"really hungry")
},
{
pattern:/\beat medicine\b/i,
message:"Lebih natural: take medicine",
fix:s=>s.replace(/eat medicine/i,"take medicine")
}
]

// =========================
// GRAMMAR RULES
// =========================
function grammarCheck(s){
let issues=[]
let rewrite=s

// need + to
if(/\bneed\s+\w+\s+eat\b/i.test(s)){
issues.push('Verb complement: need + something to eat')
rewrite="I need something to eat"
}

// modal + ing
if(/\b(will|can|must|should)\s+\w+ing\b/i.test(s)){
issues.push("Modal harus diikuti base verb")
rewrite=s.replace(/\b(will|can|must|should)\s+(\w+)ing\b/i,"$1 $2")
}

// feel crying
if(/\bfeel\s+crying\b/i.test(s)){
issues.push("feel harus like + ing")
rewrite=s.replace(/feel\s+crying/i,"feel like crying")
}

// fall crying
if(/\bfell\s+crying\b/i.test(s)){
issues.push("fell biasanya while + ing")
rewrite=s.replace(/fell\s+crying/i,"fell while crying")
}

return {issues,rewrite}
}

// =========================
// NATURAL CHECK
// =========================
function naturalCheck(s){
for(const r of naturalRules){
if(r.pattern.test(s)){
return {
issue:r.message,
rewrite:r.fix(s)
}
}
}
return null
}

// =========================
// MEANING
// =========================
function translate(s){

// simple dictionary
if(/need something to eat/i.test(s))
return "Aku butuh sesuatu untuk dimakan."

if(/feel like crying/i.test(s))
return "Aku merasa ingin menangis."

if(/fell while crying/i.test(s))
return "Aku terjatuh sambil menangis."

if(/really hungry/i.test(s))
return "Aku sangat lapar."

// fallback
return "Terjemahan otomatis belum tersedia."
}

// =========================
// ANALYZE
// =========================
function analyze(){

let text = input.value.trim()
if(!text) return

// reset
syntaxBox.style.display="block"
issuesBox.style.display="block"
rewriteBox.style.display="block"
meaningBox.style.display="block"

let grammar = grammarCheck(text)
let nat = naturalCheck(text)

let finalRewrite = text
let issues=[]

// grammar issues
if(grammar.issues.length){
issues.push(...grammar.issues)
finalRewrite = grammar.rewrite
}

// natural issues
if(nat){
issues.push("Kurang natural: "+nat.issue)
finalRewrite = nat.rewrite
}

// syntax
let subject = text.split(" ")[0]
let verb = text.split(" ")[1] || ""

syntaxBox.innerHTML = `
<h3>Syntax</h3>
Subject: ${subject}<br>
Main verb: ${verb}
`

// issues
if(issues.length){
issuesBox.innerHTML = `<h3>Issues</h3><div class="err">‚ùå ${issues.join("<br>‚ùå ")}</div>`
}else{
issuesBox.innerHTML = `<h3>Issues</h3><div class="ok">‚úî Tidak ada masalah utama</div>`
}

// rewrite
rewriteBox.innerHTML = `
<h3>Rewrite</h3>
<div class="rewrite">${finalRewrite}</div>
`

// meaning
meaningBox.innerHTML = `
<h3>Meaning</h3>
<div class="meaning">${translate(finalRewrite)}</div>
`
}

</script>
</body>
</html>
