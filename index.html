<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>English Grammar Analyzer</title>

<style>
body{
font-family:-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Arial;
background:#f4f6f5;
margin:0;
padding:20px;
display:flex;
justify-content:center;
}

.container{
width:100%;
max-width:700px;
}

h1{
font-size:32px;
margin:10px 0;
color:#2f4f46;
}

.subtitle{
color:#7b8f88;
margin-bottom:20px;
}

textarea{
width:100%;
border-radius:16px;
border:2px solid #d5dfda;
padding:16px;
font-size:18px;
resize:none;
box-sizing:border-box;
}

button{
width:100%;
margin-top:16px;
padding:16px;
border:none;
border-radius:20px;
background:#557c6e;
color:white;
font-size:20px;
cursor:pointer;
}

.card{
background:white;
border-radius:20px;
padding:20px;
margin-top:20px;
box-shadow:0 4px 12px rgba(0,0,0,0.05);
}

.highlight span.subject{color:#2a7de1;font-weight:600}
.highlight span.modal{color:#e67e22;font-weight:600}
.highlight span.verb{color:#e74c3c;font-weight:600}
.highlight span.object{color:#27ae60;font-weight:600}
.highlight span.clause{color:#8e44ad;font-weight:600}

.block{
background:#eef2ef;
border-radius:14px;
padding:14px;
margin-top:12px;
line-height:1.5;
}

.stars{
color:#f5b301;
font-size:20px;
}

</style>
</head>

<body>
<div class="container">

<h1>üß† English Grammar Analyzer</h1>
<div class="subtitle">Struktur + phrase + POS + tense + naturalness + AI</div>

<textarea id="input" rows="3" placeholder="Type sentence..."></textarea>
<button onclick="analyze()">Analyze</button>

<div id="result"></div>

</div>

<script>

function detectTense(words){
if(words.includes("will")) return "future";
if(words.includes("could")||words.includes("would")||words.includes("did")) return "modal past";
if(words.includes("am")||words.includes("is")||words.includes("are")) return "present";
return "present";
}

function detectModal(words){
const modals=["can","could","will","would","shall","should","may","might","must"];
return words.find(w=>modals.includes(w));
}

function detectVerb(words){
const verbs=["go","make","take","do","come","be","have","see","say","get"];
return words.find(w=>verbs.includes(w));
}

function detectClause(sentence){
if(sentence.includes("because")) return sentence.split("because")[1].trim();
if(sentence.includes("that")) return sentence.split("that")[1].trim();
return "";
}

function highlight(sentence){
let s=sentence;

s=s.replace(/\b(I|you|he|she|they|we)\b/gi,"<span class='subject'>$1</span>");
s=s.replace(/\b(can|could|will|would|should|may|might|must)\b/gi,"<span class='modal'>$1</span>");
s=s.replace(/\b(make|go|take|do|come|be|have|get)\b/gi,"<span class='verb'>$1</span>");
s=s.replace(/\b(to .*?)(?= because|$)/gi,"<span class='object'>$1</span>");
s=s.replace(/\bbecause .*$/gi,"<span class='clause'>$&</span>");

return s;
}

function naturalness(sentence){
if(sentence.length>8) return 5;
if(sentence.length>5) return 4;
return 3;
}

function rewrite(sentence){
return sentence;
}

async function translate(text){
try{
const res = await fetch("https://libretranslate.de/translate",{
method:"POST",
headers:{"Content-Type":"application/json"},
body:JSON.stringify({
q:text,
source:"en",
target:"id",
format:"text"
})
});
const data=await res.json();
return data.translatedText;
}catch(e){
return "(terjemahan gagal)";
}
}

async function analyze(){
const text=document.getElementById("input").value.trim();
if(!text) return;

const words=text.toLowerCase().split(/\s+/);

const subject=words[0];
const modal=detectModal(words)||"-";
const verb=detectVerb(words)||"-";
const clause=detectClause(text)||"-";
const tense=detectTense(words);
const nat=naturalness(words);

const translation=await translate(text);

document.getElementById("result").innerHTML=`
<div class="card">
<div class="highlight" style="font-size:22px;margin-bottom:12px">${highlight(text)}</div>

<div style="margin-bottom:10px"><b>Arti:</b> ${translation}</div>

<div class="block">
<b>Subject:</b> ${subject}<br>
<b>Modal:</b> ${modal}<br>
<b>Verb:</b> ${verb}<br>
<b>Clause:</b> ${clause}<br>
<b>Tense:</b> ${tense}
</div>

<div style="margin-top:12px">
<b>Naturalness:</b>
<span class="stars">${"‚≠ê".repeat(nat)}</span>
</div>

<div style="margin-top:10px">
<b>Native:</b> ${rewrite(text)}
</div>

</div>
`;
}

</script>
</body>
</html>