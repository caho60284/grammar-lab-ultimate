<!DOCTYPE html>
<html lang="id">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>English Grammar AI Analyzer</title>

<style>
body{
font-family:system-ui,-apple-system,Segoe UI,Roboto;
background:#f4f7f6;
margin:0;
padding:20px;
color:#1f3d35;
}

h1{
font-size:28px;
margin-bottom:4px;
}

.subtitle{
color:#6b7f78;
margin-bottom:20px;
}

textarea{
width:100%;
border-radius:14px;
border:1px solid #ccd7d3;
padding:16px;
font-size:18px;
box-sizing:border-box;
min-height:110px;
}

button{
width:100%;
margin-top:14px;
padding:16px;
border:none;
border-radius:14px;
background:#3f6f60;
color:white;
font-size:18px;
cursor:pointer;
}

.card{
background:white;
border-radius:16px;
padding:16px;
margin-top:18px;
box-shadow:0 2px 6px rgba(0,0,0,0.06);
}

table{
width:100%;
border-collapse:collapse;
}

th,td{
padding:10px;
border-bottom:1px solid #e6eeea;
text-align:left;
}

th{
color:#4a6b61;
}
</style>
</head>
<body>

<h1>ðŸ§  English Grammar AI Analyzer</h1>
<div class="subtitle">Analisis struktur + naturalitas + arti otomatis</div>

<textarea id="input" placeholder="Tulis kalimat Inggris..."></textarea>
<button onclick="analyze()">Analyze</button>

<div id="result"></div>

<script>
async function analyze(){

const text=document.getElementById("input").value.trim()
if(!text)return

document.getElementById("result").innerHTML="Menganalisis..."

const prompt=`
Analisis kalimat bahasa Inggris berikut secara linguistik.

Kalimat: "${text}"

Balas HANYA JSON valid dengan format:
{
"segments":[
{"text":"","role":"","type":"","explanation":""}
],
"natural":"natural / kurang natural / salah",
"rewrite":"",
"meaning":"",
"idiom":""
}
`

try{

const res=await fetch("https://api.openai.com/v1/chat/completions",{
method:"POST",
headers:{
"Content-Type":"application/json",
"Authorization":"Bearer YOUR_API_KEY"
},
body:JSON.stringify({
model:"gpt-4o-mini",
messages:[{role:"user",content:prompt}],
temperature:0.2
})
})

const data=await res.json()
const content=data.choices[0].message.content
const json=JSON.parse(content)

render(json)

}catch(e){
document.getElementById("result").innerHTML="Error AI"
}

}

function render(j){

let html=`<div class="card">
<table>
<tr><th>Bagian</th><th>Peran</th><th>Jenis</th><th>Penjelasan</th></tr>`

j.segments.forEach(s=>{
html+=`<tr>
<td>${s.text}</td>
<td>${s.role}</td>
<td>${s.type}</td>
<td>${s.explanation}</td>
</tr>`
})

html+=`</table></div>`

html+=`<div class="card"><b>Naturalitas:</b> ${j.natural}</div>`

if(j.rewrite){
html+=`<div class="card"><b>Rewrite:</b> ${j.rewrite}</div>`
}

if(j.meaning){
html+=`<div class="card"><b>Meaning:</b> ${j.meaning}</div>`
}

if(j.idiom){
html+=`<div class="card"><b>Idiom/Phrase:</b> ${j.idiom}</div>`
}

document.getElementById("result").innerHTML=html
}
</script>

</body>
</html>