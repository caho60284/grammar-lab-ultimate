<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Grammar Lab Ultimate</title>

<style>
body{
font-family:-apple-system,BlinkMacSystemFont,"Segoe UI",Roboto;
background:#f4f6f5;
margin:0;
padding:24px;
display:flex;
justify-content:center;
}

.container{
width:100%;
max-width:720px;
}

h1{
color:#3f5f53;
margin-bottom:6px;
}

.sub{
color:#7c8f86;
margin-bottom:20px;
}

textarea{
width:100%;
padding:18px;
border-radius:16px;
border:2px solid #cfd8d3;
font-size:18px;
resize:none;
}

button{
width:100%;
margin-top:16px;
padding:16px;
border:none;
border-radius:26px;
background:#5d776c;
color:white;
font-size:18px;
}

.card{
margin-top:22px;
background:white;
border-radius:20px;
padding:20px;
box-shadow:0 4px 12px rgba(0,0,0,0.08);
}

.arti{
margin-top:10px;
font-size:18px;
}

.box{
background:#eef1ef;
border-radius:14px;
padding:14px;
margin-top:14px;
line-height:1.6;
}

.label{
font-weight:600;
}

.stars{
color:#e2b400;
font-size:22px;
margin-top:10px;
}

.native{
margin-top:10px;
}

/* warna grammar */
.subj{color:#4f7cff;font-weight:600}
.modal{color:#e67e22;font-weight:600}
.verb{color:#e74c3c;font-weight:600}
.obj{color:#2ecc71;font-weight:600}
.clause{color:#8e44ad;font-weight:600}
</style>
</head>

<body>
<div class="container">

<h1>ðŸ§  Grammar Lab Ultimate</h1>
<div class="sub">Struktur + POS + tense + naturalness + AI</div>

<textarea id="input" rows="3" placeholder="Type sentence..."></textarea>
<button onclick="analyze()">Analyze</button>

<div id="result" class="card" style="display:none"></div>

</div>

<script>
async function translate(text){
try{
let r=await fetch("https://translate.googleapis.com/translate_a/single?client=gtx&sl=en&tl=id&dt=t&q="+encodeURIComponent(text))
let j=await r.json()
return j[0].map(x=>x[0]).join("")
}catch{return ""}
}

function splitClause(s){
let words=s.split(" ")
let idx=words.findIndex(w=>["because","that","who","which","when","if","you","she","he","they"].includes(w.toLowerCase()))
if(idx>0){
return{
main:words.slice(0,idx).join(" "),
sub:words.slice(idx).join(" ")
}
}
return{main:s,sub:""}
}

function parseSimple(s){
let w=s.split(" ")
let subject=w[0]
let modal=["can","could","will","would","should","may","might","must"].includes(w[1]?.toLowerCase())?w[1]:""
let verb=modal?w[2]:w[1]
let rest=modal?w.slice(3):w.slice(2)
return{
subject,modal,verb,rest:rest.join(" ")
}
}

function highlight(p){
let out=[]
if(p.subject)out.push(`<span class="subj">${p.subject}</span>`)
if(p.modal)out.push(`<span class="modal">${p.modal}</span>`)
if(p.verb)out.push(`<span class="verb">${p.verb}</span>`)
if(p.rest)out.push(`<span class="obj">${p.rest}</span>`)
return out.join(" ")
}

async function analyze(){
let text=document.getElementById("input").value.trim()
if(!text)return

let tr=await translate(text)
let parts=splitClause(text)

let main=parseSimple(parts.main)
let sub=parts.sub?parseSimple(parts.sub):null

let html=`<div style="font-size:20px;margin-bottom:8px">${highlight(main)} ${sub?`<span class="clause">${parts.sub}</span>`:""}</div>`
html+=`<div class="arti"><b>Arti:</b> ${tr||"(terjemahan gagal)"}</div>`

html+=`<div class="box">
<div><span class="label">Subject:</span> ${main.subject||"-"}</div>
<div><span class="label">Modal:</span> ${main.modal||"-"}</div>
<div><span class="label">Verb:</span> ${main.verb||"-"}</div>
<div><span class="label">Object/Phrase:</span> ${main.rest||"-"}</div>
${sub?`<div><span class="label">Clause:</span> ${parts.sub}</div>`:""}
</div>`

html+=`<div class="stars">â˜…â˜…â˜…â˜…â˜…</div>`
html+=`<div class="native"><b>Native:</b> ${text}</div>`

document.getElementById("result").innerHTML=html
document.getElementById("result").style.display="block"
}
</script>

</body>
</html>