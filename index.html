<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Grammar Lab Ultimate</title>

<style>
body{
font-family:-apple-system,BlinkMacSystemFont,"Segoe UI",Roboto;
background:#f2f5f3;
margin:0;
padding:24px 14px;
display:flex;
justify-content:center;
}

.container{
width:100%;
max-width:680px;
}

h1{
color:#3f5f53;
margin-bottom:6px;
padding:0 6px;
}

.sub{
color:#7c8f86;
margin-bottom:22px;
padding:0 6px;
}

textarea{
width:100%;
padding:18px;
border-radius:18px;
border:2px solid #cfd8d3;
font-size:18px;
resize:none;
box-sizing:border-box;
}

button{
width:100%;
margin-top:18px;
padding:18px;
border:none;
border-radius:30px;
background:#5d776c;
color:white;
font-size:19px;
}

.card{
margin-top:24px;
background:white;
border-radius:22px;
padding:22px;
box-shadow:0 6px 18px rgba(0,0,0,0.08);
}

.arti{
margin-top:12px;
font-size:18px;
}

.box{
background:#eef1ef;
border-radius:16px;
padding:16px;
margin-top:16px;
line-height:1.6;
}

.label{
font-weight:600;
}

.stars{
color:#e2b400;
font-size:22px;
margin-top:12px;
}

.native{
margin-top:10px;
}

/* warna */
.subj{color:#4f7cff;font-weight:600}
.copula{color:#e74c3c;font-weight:600}
.modal{color:#e67e22;font-weight:600}
.adj{color:#2ecc71;font-weight:600}
.obj{color:#2ecc71;font-weight:600}
.clause{color:#8e44ad;font-weight:600}
</style>
</head>

<body>
<div class="container">

<h1>ðŸ§  Grammar Lab Ultimate</h1>
<div class="sub">Struktur + POS + tense + naturalness + AI</div>

<textarea id="input" rows="3" placeholder="Type sentence..."></textarea>
<button onclick="analyze()">Analyze</button>

<div id="result" class="card" style="display:none"></div>

</div>

<script>
async function translate(text){
try{
let r=await fetch("https://translate.googleapis.com/translate_a/single?client=gtx&sl=en&tl=id&dt=t&q="+encodeURIComponent(text))
let j=await r.json()
return j[0].map(x=>x[0]).join("")
}catch{return ""}
}

function splitClause(s){
let m=s.match(/\b(because|that|who|which|when|if|you|she|he|they)\b/i)
if(m){
let idx=s.toLowerCase().indexOf(m[0].toLowerCase())
return{
main:s.slice(0,idx).trim(),
sub:s.slice(idx).trim()
}
}
return{main:s,sub:""}
}

function parseMain(s){
let w=s.split(" ")

let subject=w[0]
let copulas=["am","is","are","was","were","'m","'re","'s"]
let modalList=["can","could","will","would","should","may","might","must"]

let verb=""
let modal=""
let complement=""

if(copulas.includes(w[1]?.toLowerCase())){
verb=w[1]
complement=w.slice(2).join(" ")
return{type:"copula",subject,verb,complement}
}

if(modalList.includes(w[1]?.toLowerCase())){
modal=w[1]
verb=w[2]
complement=w.slice(3).join(" ")
return{type:"modal",subject,modal,verb,complement}
}

verb=w[1]
complement=w.slice(2).join(" ")
return{type:"verb",subject,verb,complement}
}

function highlight(main,sub){
let html=""

if(main.type==="copula"){
html+=`<span class="subj">${main.subject}</span> `
html+=`<span class="copula">${main.verb}</span> `
html+=`<span class="adj">${main.complement}</span>`
}

if(main.type==="modal"){
html+=`<span class="subj">${main.subject}</span> `
html+=`<span class="modal">${main.modal}</span> `
html+=`<span class="copula">${main.verb}</span> `
html+=`<span class="obj">${main.complement}</span>`
}

if(main.type==="verb"){
html+=`<span class="subj">${main.subject}</span> `
html+=`<span class="copula">${main.verb}</span> `
html+=`<span class="obj">${main.complement}</span>`
}

if(sub){
html+=` <span class="clause">${sub}</span>`
}

return html
}

async function analyze(){
let text=document.getElementById("input").value.trim()
if(!text)return

let tr=await translate(text)
let parts=splitClause(text)
let main=parseMain(parts.main)

let html=`<div style="font-size:20px;margin-bottom:10px">${highlight(main,parts.sub)}</div>`
html+=`<div class="arti"><b>Arti:</b> ${tr||"(terjemahan gagal)"}</div>`

html+=`<div class="box">
<div><span class="label">Subject:</span> ${main.subject||"-"}</div>
${main.modal?`<div><span class="label">Modal:</span> ${main.modal}</div>`:""}
<div><span class="label">Verb:</span> ${main.verb||"-"}</div>
<div><span class="label">Complement:</span> ${main.complement||"-"}</div>
${parts.sub?`<div><span class="label">Clause:</span> ${parts.sub}</div>`:""}
</div>`

html+=`<div class="stars">â˜…â˜…â˜…â˜…â˜…</div>`
html+=`<div class="native"><b>Native:</b> ${text}</div>`

document.getElementById("result").innerHTML=html
document.getElementById("result").style.display="block"
}
</script>

</body>
</html>